---
title: 'Homework - CUNY DATA 624 Sum I'
subtitle: 'Group 1: Daniel Sullivan, Jeff Parks, Lwin Shwe, Matthew Katz'
format:
  docx:
    highlight-style: arrow
page-layout: article
editor: visual
---

```{r setup, include=FALSE}
# chunks
knitr::opts_chunk$set(echo=TRUE, eval=TRUE, include=TRUE, message=FALSE, 
warning=FALSE, fig.show="hold", out.width="100%", fig.height=4)

# libraries
library(tidyverse)
library(kableExtra)
library(fpp2)

# ggplot
theme_set(theme_light())
```

## HA Exercise 6.2

The `plastics` data set consists of the monthly sales (in thousands) of product A for a plastics manufacturer for five years.

a.  **Plot the time series of sales of product A. Can you identify seasonal fluctuations and/or a trend-cycle?**

Before applying any calculations, we can observe a rising trend-cycle over the five years, with an annual seasonality where sales peak towards mid-year and then drop off rapidly.

```{r}
autoplot(plastics) +
  ggtitle('Monthly Plastics Sales') +
  ylab('Units Sold') +
  xlab('Year')

```

{{< pagebreak >}}

b.  **Use a classical multiplicative decomposition to calculate the trend-cycle and seasonal indices.**\

```{r}
plastics %>% decompose(type='multiplicative') %>%
  autoplot() + 
  xlab('Year') + 
  ggtitle("Monthly Plastics Sales: Classical Mult Decomp")
```

{{< pagebreak >}}

c.  **Do the results support the graphical interpretation from part a?**

The results of the Classical Decomposition do seem to support the graphical interpretation. The trend-cycle decomposition shows a clear, increasing trend throughout the five years, and the seasonal decomposition shows a clear, repetitive annual cycle with a mid-year sales peak.

d.  **Compute and plot the seasonally adjusted data.**\

```{r}
plastics_decomp <- plastics %>% decompose(type='multiplicative')

plastics_decomp$seasonal_adj <- plastics_decomp$x / plastics_decomp$seasonal

autoplot(plastics_decomp$x, series='Data') + 
  autolayer(plastics_decomp$seasonal_adj, series='Seasonally Adj') +
  ggtitle('Monthly Plastic Sales') + 
  xlab('Year') +
  ylab('Sales')
```

{{< pagebreak >}}

e.  **Change one observation to be an outlier (e.g., add 500 to one observation), and recompute the seasonally adjusted data. What is the effect of the outlier?**

The addition of an outlier near the middle of the dataset produces a spike in both the non-decomposed data and the seasonally adjusted data. However the overall trend-cycle and seasonality seem to return to their established patterns immediately.

```{r}
plastics_out <- plastics
plastics_out[36] <- plastics_out[36] + 500

plastics_out_decomp <- plastics_out %>% decompose(type='multiplicative')
plastics_out_decomp$seasonal_adj <- plastics_out_decomp$x / plastics_out_decomp$seasonal

autoplot(plastics_out_decomp$x, series='Data') + 
  autolayer(plastics_out_decomp$seasonal_adj, series='Seasonally Adj') +
  ggtitle('Monthly Plastic Sales') + 
  xlab('Year') +
  ylab('Sales')
```

{{< pagebreak >}}

f.  **Does it make any difference if the outlier is near the end rather than in the middle of the time series?**

The addition of an outlier towards the end of the dataset produces a spike in both the non-decomposed data and the seasonally adjusted data. However the overall trend-cycle and seasonality seem to return to their established patterns immediately - it does not seem to make much difference where this new outlier is placed.

```{r}
plastics_out2 <- plastics
plastics_out2[58] <- plastics_out[58] + 500

plastics_out2_decomp <- plastics_out2 %>% decompose(type='multiplicative')
plastics_out2_decomp$seasonal_adj <- plastics_out2_decomp$x / plastics_out2_decomp$seasonal

autoplot(plastics_out2_decomp$x, series='Data') + 
  autolayer(plastics_out2_decomp$seasonal_adj, series='Seasonally Adj') +
  ggtitle('Monthly Plastic Sales') + 
  xlab('Year') +
  ylab('Sales')
```
